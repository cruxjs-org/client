import {signal,effect}from'@minejs/signals';import {setupAuto,getI18n}from'@minejs/i18n';import {EventsManager,WindowManager,createRouter}from'@minejs/browser';var a=class{constructor(t){this.lifecycle="booting";this.hooks={};this.routeComponents={};this.currentPathSignal=signal(window.location.pathname??"/");this.config=t,this.debug=t.debug??false,this.log("[INIT] Creating ClientManager"),this.routeComponents=t.routes,this.eventsManager=new EventsManager,this.windowManager=new WindowManager;let e=Object.entries(t.routes).map(([n,o])=>({path:n,component:o}));this.router=createRouter({routes:e,notFoundComponent:t.notFoundComponent}),this.router.afterEach(n=>{this.currentPathSignal.set(n.path);}),this.log("[INIT] ClientManager created");}on(t,e,n,o){return typeof t=="string"&&t.startsWith("on")?(this.hooks[t]=e,this):this.eventsManager.on(t,e,n,o)}async boot(){if(this.lifecycle!=="booting"){console.warn("[ClientManager] Already booted or destroyed");return}this.log("\u26A1 Phase: BOOT");try{this.config.i18n&&await this.setupI18n(this.config.i18n),this.hooks.onBoot&&(this.log("\u2192 Calling onBoot hook"),await this.hooks.onBoot()),this.log("\u2713 BOOT phase complete");}catch(t){throw console.error("[ClientManager] Boot failed:",t),t}}async ready(t){if(this.lifecycle!=="booting"){console.warn("[ClientManager] Cannot ready - not in booting phase");return}this.log("\u26A1 Phase: READY");try{this.mount(t),this.log("\u2192 Router mounted"),this.debug&&(globalThis.__CLIENT_MANAGER__=this,this.log("\u2192 ClientManager available globally")),this.hooks.onReady&&(this.log("\u2192 Calling onReady hook"),await this.hooks.onReady()),this.lifecycle="ready",this.log("\u2713 READY phase complete"),this.log("\u2713 App is ready!");}catch(e){throw console.error("[ClientManager] Ready failed:",e),e}}async destroy(){if(this.lifecycle==="destroyed"){console.warn("[ClientManager] Already destroyed");return}this.lifecycle="destroying",this.log("\u26A1 Phase: DESTROY");try{this.hooks.onDestroy&&(this.log("\u2192 Calling onDestroy hook"),await this.hooks.onDestroy()),this.eventsManager.destroy(),this.windowManager.destroy(),this.lifecycle="destroyed",this.log("\u2713 DESTROY phase complete");}catch(t){throw console.error("[ClientManager] Destroy failed:",t),t}}async setupI18n(t){this.log("Setting up i18n...");try{await setupAuto({defaultLanguage:t.defaultLanguage,supportedLanguages:t.supportedLanguages,basePath:t.basePath,fileExtension:t.fileExtension||"json"}),this.log(`i18n ready \u2192 ${t.supportedLanguages.join(", ")}`);}catch(e){throw this.log("Failed to setup i18n"+e.message),e}}navigate(t){this.router.push(t);}mount(t){let e=typeof t=="string"?document.querySelector(t):t;if(!e){console.warn("[ClientManager] Mount target not found:",t);return}effect(()=>{let n=this.currentPathSignal(),o=this.routeComponents[n]||this.config.notFoundComponent||null;if(e.innerHTML="",o){let s=o();s instanceof Node&&e.appendChild(s);}else e.innerHTML="<p>No component found for this route</p>";this.log(`\u2192 Route changed to: ${n}`);}),this.log("\u2192 Routing setup complete");}getCurrentPath(){return this.currentPathSignal}createLinkHandler(t){return e=>{e.preventDefault(),this.navigate(t);}}getRouter(){return this.router}off(t,e,n){this.eventsManager.off(t,e,n);}getEventsManager(){return this.eventsManager}getViewport(){return this.windowManager.getViewport()}getWindowManager(){return this.windowManager}getI18n(){return getI18n()}getTranslation(t,e){let n=getI18n();return n?n.t(t)??e??t:(console.warn("[ClientManager] i18n not initialized. Using default value or key."),e??t)}getPhase(){return this.lifecycle}isReady(){return this.lifecycle==="ready"}log(t){this.debug&&console.log(`[ClientManager] ${t}`);}};function C(){let r=getI18n();return {getTranslation:(t,e)=>r?r.t(t)??e??t:e??t,t:(t,e)=>r?r.t(t)??e??t:e??t}}export{a as ClientManager,C as useTranslation};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map